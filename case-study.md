Уложился в бюджет. К сожалению, за описание case-study сел почти две недели спустя выполнения ДЗ, плохо помню. 

- Получилось странно, но я решил пойти по пунктам из readme.md и сразу переписал программу на "потоковый подход".
После первой же попытки (когда переписал на потоковый и тест прошел) метрика оказалась близкой к нужному результату, погонял профайлеры немного и довел до бюджета.